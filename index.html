<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•œêµ­ì–´ ëŠ¥ë ¥ í‰ê°€ ì‹¤í—˜</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            margin: 0;
            min-height: 100vh;
        }
        .container { 
            max-width: 900px; 
            margin: 0 auto; 
            background: white; 
            padding: 30px; 
            border-radius: 15px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .header { 
            text-align: center; 
            margin-bottom: 30px; 
            color: #667eea; 
            border-bottom: 2px solid #667eea;
            padding-bottom: 20px;
        }
        .instructions { 
            background: #f8f9fa; 
            padding: 25px; 
            border-radius: 10px; 
            margin-bottom: 30px;
            border-left: 4px solid #667eea;
        }
        .instructions h3 { 
            color: #667eea; 
            margin-top: 15px; 
            margin-bottom: 10px;
        }
        .instructions ul { 
            line-height: 1.8; 
            padding-left: 20px;
        }
        .instructions li { 
            margin-bottom: 8px; 
        }
        .contact-info {
            background: #e3f2fd;
            padding: 12px;
            border-radius: 5px;
            margin-top: 15px;
            font-weight: bold;
            color: #1976d2;
        }
        .timer { 
            background: #ff6b6b; 
            color: white; 
            padding: 15px; 
            text-align: center; 
            border-radius: 10px; 
            margin: 20px 0; 
            font-size: 1.2em; 
            font-weight: bold; 
        }
        .passage { 
            border: 2px solid #e0e0e0; 
            border-radius: 10px; 
            padding: 25px; 
            margin: 20px 0; 
            background: #fafafa;
        }
        .passage h3 { 
            color: #667eea; 
            margin-bottom: 15px; 
            font-size: 1.3em;
        }
        .passage-text { 
            line-height: 2; 
            font-size: 1.1em; 
        }
        .blank { 
            display: inline-block; 
            width: 28px; 
            height: 28px; 
            border: none;
            border-bottom: 2px solid #667eea; 
            margin: 0 3px; 
            text-align: center; 
            font-size: 1em; 
            background: #f8f9ff; 
            padding: 2px;
            vertical-align: baseline;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            border-radius: 0;
        }
        .blank:focus { 
            outline: none; 
            background: #fff; 
            border-bottom-color: #ff6b6b; 
            box-shadow: 0 2px 5px rgba(102,126,234,0.3);
        }
        .btn { 
            padding: 15px 30px; 
            background: #667eea; 
            color: white; 
            border: none; 
            border-radius: 8px; 
            font-size: 1.1em; 
            cursor: pointer; 
            margin: 10px; 
        }
        .btn:hover { 
            background: #5a6fd8; 
            transform: translateY(-2px);
        }
        .form-group { 
            margin: 15px 0; 
        }
        .form-group label { 
            display: block; 
            margin-bottom: 5px; 
            font-weight: bold; 
        }
        .form-group input, .form-group select { 
            padding: 10px; 
            width: 100%; 
            max-width: 300px; 
            border: 1px solid #ddd; 
            border-radius: 5px; 
        }
        .results { 
            display: none; 
            text-align: center; 
            padding: 30px; 
            background: #f0f8ff;
            border-radius: 10px;
        }
        .score { 
            font-size: 3em; 
            color: #667eea; 
            font-weight: bold; 
        }
        .participant-info { 
            background: #f0f8ff; 
            padding: 20px; 
            border-radius: 10px; 
            margin: 20px 0; 
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Part 2. ìˆ™ë‹¬ë„ ê³¼ì œ</h1>
            <h2 style="color: #6c757d; font-size: 1.3em; margin-top: 10px;">í•œêµ­ì–´ C-Test ì˜¨ë¼ì¸ í‰ê°€</h2>
        </div>

        <div id="startForm">
            <div class="instructions">
                <h3>ğŸ“‹ ì‹¤í—˜ ì•ˆë‚´</h3>
                <p>ì´ í…ŒìŠ¤íŠ¸ëŠ” í•œêµ­ì–´ ëŠ¥ë ¥ì„ í‰ê°€í•˜ê¸° ìœ„í•œ C-Testì…ë‹ˆë‹¤.</p>
                
                <h3>ì§„í–‰ ë°©ë²•</h3>
                <ul>
                    <li>ê° ë¬¸ì¥ì—ì„œ ë¹ˆì¹¸ì— ë“¤ì–´ê°ˆ ì•Œë§ì€ ê¸€ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</li>
                    <li><strong>í•œ ì¹¸ ë‹¹ í•œ ê¸€ì</strong>ë§Œ ì…ë ¥ë©ë‹ˆë‹¤</li>
                    <li>ëª¨ë“  ë¬¸í•­ì„ ì™„ë£Œí•œ í›„ í•˜ë‹¨ì˜ 'ì‹œí—˜ ì™„ë£Œ' ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”</li>
                    <li>ì œí•œ ì‹œê°„ì€ 20ë¶„ì…ë‹ˆë‹¤</li>
                </ul>
                
                <h3>ìœ ì˜ì‚¬í•­</h3>
                <ul>
                    <li>ì‹œí—˜ ì™„ë£Œ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ë‹µë³€ì´ ì €ì¥ë©ë‹ˆë‹¤</li>
                    <li>ì‹œê°„ì´ ì¢…ë£Œë˜ë©´ ìë™ìœ¼ë¡œ ì œì¶œë©ë‹ˆë‹¤</li>
                    <li>í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ë©´ ì…ë ¥í•œ ë‹µë³€ì´ ëª¨ë‘ ì‚¬ë¼ì§ˆ ìˆ˜ ìˆìœ¼ë‹ˆ ì£¼ì˜í•´ì£¼ì„¸ìš”</li>
                    <li><strong>í•œ ë²ˆ ì œì¶œí•˜ë©´ ìˆ˜ì •í•  ìˆ˜ ì—†ìœ¼ë‹ˆ ì‹ ì¤‘íˆ ì‘ì„±í•´ì£¼ì„¸ìš”</strong></li>
                </ul>
                
                <div class="contact-info">
                    â€» ë¬¸ì˜ _ ì´ìœ ì€ ì¹´ì¹´ì˜¤ ID: lee_yueun
                </div>
            </div>

            <h2>ì°¸ì—¬ì ì •ë³´</h2>
            <div class="participant-info">
                <div class="form-group">
                    <label>ì´ë¦„:</label>
                    <input type="text" id="pname" placeholder="ì˜ˆ: í™ê¸¸ë™" required>
                </div>
                <div class="form-group">
                    <label>ë‚˜ì´:</label>
                    <input type="number" id="age" placeholder="ì˜ˆ: 25" required>
                </div>
                <div class="form-group">
                    <label>ì „ê³µ:</label>
                    <input type="text" id="major" placeholder="ì˜ˆ: ê²½ì˜í•™" required>
                </div>
                <div class="form-group">
                    <label>ëª¨ì–´:</label>
                    <input type="text" id="lang" placeholder="ì˜ˆ: English" required>
                </div>
                <div class="form-group">
                    <label>í•œêµ­ì–´ í•™ìŠµ ê¸°ê°„:</label>
                    <select id="duration" required>
                        <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                        <option value="6ê°œì›” ë¯¸ë§Œ">6ê°œì›” ë¯¸ë§Œ</option>
                        <option value="6ê°œì›”-1ë…„">6ê°œì›”-1ë…„</option>
                        <option value="1-3ë…„">1-3ë…„</option>
                        <option value="3-5ë…„">3-5ë…„</option>
                        <option value="5ë…„ ì´ìƒ">5ë…„ ì´ìƒ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ì´ë©”ì¼:</label>
                    <input type="email" id="email" placeholder="example@email.com" required>
                </div>
                <div class="form-group">
                    <label>í•¸ë“œí°:</label>
                    <input type="tel" id="phone" placeholder="010-1234-5678" required>
                </div>
            </div>
            <button class="btn" onclick="startTest()">ì‹œí—˜ ì‹œì‘ (20ë¶„)</button>
        </div>

        <div id="testArea" style="display:none;">
            <div class="timer" id="timer">ë‚¨ì€ ì‹œê°„: 20:00</div>

            <div class="passage">
                <h3>ì§€ë¬¸ 1: ì¼ìƒìƒí™œ (Level 1)</h3>
                <div class="passage-text">
                    ì•ˆë…•í•˜ì„¸ìš”. ì œ ì´ë¦„ì€ ê¹€ì² ìˆ˜ì…ë‹ˆë‹¤. ì €ëŠ” ëŒ€í•™<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="êµ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì—" maxlength="1">ë‹¤ë‹™ë‹ˆë‹¤.
                    ì•„ì¹¨ì— ì¼ì–´<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë‚˜" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì„œ" maxlength="1">í•™êµ ì²´ìœ¡<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê´€" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì—" maxlength="1">ê°‘ë‹ˆë‹¤. ì²´ìœ¡<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê´€" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì—" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì„œ" maxlength="1">ìš´ë™ì„ í•©<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë‹ˆ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë‹¤" maxlength="1">.
                    ìš´ë™ì„ í•œ ë‹¤<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ìŒ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì—" maxlength="1">ì•„ì¹¨ì„ ë¨¹ìŠµë‹ˆë‹¤. ì•„ì¹¨ì€ ê¸°ìˆ™<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì‚¬" maxlength="1">ì‹ë‹¹ì—ì„œ ë¨¹ìŠµë‹ˆë‹¤. ì €ëŠ” ëŒ€í•™<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="êµ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì—" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì„œ" maxlength="1">í•œêµ­ì–´ë¥¼ ë°°<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì›" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë‹ˆ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë‹¤" maxlength="1">. í•œêµ­ì–´ ìˆ˜<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì—…" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì€" maxlength="1">ë§¤ì¼
                    ì˜¤<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì „" maxlength="1">10ì‹œì— ì‹œì‘<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="í•©" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë‹ˆ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë‹¤" maxlength="1">. í•œêµ­ì–´ëŠ” ì“°<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê¸°" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì™€" maxlength="1">ë§í•˜ê¸°ê°€ ì–´<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë µ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ìŠµ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë‹ˆ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë‹¤" maxlength="1">.
                    ê·¸ë ‡ì§€ë§Œ ë“£<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê¸°" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì™€" maxlength="1">ì½ê¸°ëŠ” ì‰½<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ìŠµ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë‹ˆ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë‹¤" maxlength="1">. í•œêµ­ì–´ ë°°<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ìš°" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ëŠ”" maxlength="1">ê²ƒì´ ì°¸ ì¬ë¯¸<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ìˆ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ìŠµ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë‹ˆ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë‹¤" maxlength="1">. ì£¼ë§ì—ëŠ” ì¹œ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="êµ¬" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì™€" maxlength="1">ê°™ì´ ê·¹<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì¥" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì—" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì„œ" maxlength="1">ì˜í™”ë¥¼ ë´…ë‹ˆë‹¤. ì˜í™”ë¥¼ <input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë³¸" maxlength="1">
                    í›„ì— í•œêµ­ ì‹ë‹¹ì—ì„œ ì €<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë…" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì„" maxlength="1">ë¨¹ìŠµë‹ˆë‹¤. í•œêµ­ ì‹<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë‹¹" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì´" maxlength="1">ê·¹ì¥ ë°”<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë¡œ" maxlength="1">ì˜†ì—
                    ìˆìŠµë‹ˆë‹¤. ë¶ˆê³ <input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê¸°" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê°€" maxlength="1">ë§›ìˆìŠµë‹ˆë‹¤. ê¹€ì¹˜ì°Œê°œëŠ” ë§µìŠµë‹ˆë‹¤.
                </div>
            </div>

            <div class="passage">
                <h3>ì§€ë¬¸ 2: ì—¬í–‰ ê³„íš (Level 1+)</h3>
                <div class="passage-text">
                    ì˜¬ ì—¬ë¦„ì—ëŠ” ê°€ì¡±ë“¤ê³¼ í•¨ê»˜ ì œì£¼ë„ì— ì—¬í–‰ì„ ê°€ë ¤ê³  í•´ìš”. ì œ
                    ì£¼ë„ëŠ” í•œë°˜<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë„" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì˜" maxlength="1">ë‚¨ìª½ì— ìˆ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ëŠ”" maxlength="1">ì„¬ì´ì˜ˆìš”. í•œêµ­ì˜ í•˜ì™€ì´ë¼ ë¶ˆ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë¦¬" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ëŠ”" maxlength="1">
                    ì œì£¼ë„ëŠ” ì<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì—°" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì´" maxlength="1">ì•„ë¦„ë‹¤ì›Œì„œ ì‹ í˜¼<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì—¬" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="í–‰" maxlength="1">ì¥ì†Œë¡œ ì¸<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê¸°" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê°€" maxlength="1">êµ‰ì¥íˆ ë§<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì•„" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ìš”" maxlength="1">. ì˜¤ëŠ˜ì€ ì—¬í–‰<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì‚¬" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì—" maxlength="1">ì „í™”ë¥¼ ê±¸<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì–´" maxlength="1">ì„œìš¸ì—ì„œ ì œì£¼ë„<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê¹Œ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì§€" maxlength="1">ì™•ë³µ ë¹„
                    í–‰<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê¸°" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="í‘œ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë¥¼" maxlength="1">ë„¤ì¥ ì˜ˆ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì•½" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="í–ˆ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì–´" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ìš”" maxlength="1">. ì—¬í–‰<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì‚¬" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì—" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì„œ" maxlength="1">í˜¸í…”ë„ ì†Œê°œ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="í•´" maxlength="1">ì£¼ì—ˆì§€ë§Œ í˜¸
                    í…”ì€ ì•„ì§ ì•ˆ ì •<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="í–ˆ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì–´" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ìš”" maxlength="1">. ì¸í„°ë„·ìœ¼ë¡œ ì •<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë³´" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë¥¼" maxlength="1">ë” ì°¾ì•„ ë³´<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê³ " maxlength="1">ì–´ëŠ í˜¸
                    í…”ì´ ì¢‹<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì€" maxlength="1">ì§€ ì•Œì•„ ë³´<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë ¤" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê³ " maxlength="1">í•´ìš”. ìš”<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì¦˜" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì€" maxlength="1">ì¸í„°ë„·ì´ ìˆ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì–´" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì„œ" maxlength="1">í˜¸í…” ë¿
                    ì•„<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë‹ˆ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë¼" maxlength="1">ìœ ëª…í•œ ê´€<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê´‘" maxlength="1">ëª…ì†Œì™€ ë§›<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ìˆ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ëŠ”" maxlength="1">ì‹ë‹¹ë„ ì°¾ì•„ ë³¼ <input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ìˆ˜" maxlength="1">ìˆì–´ì„œ ì°¸
                    í¸ë¦¬í•´ìš”.
                </div>
            </div>

            <div class="passage">
                <h3>ì§€ë¬¸ 3: ë°±í™”ì  ê´‘ê³  (Level 1+)</h3>
                <div class="passage-text">
                    ì•ˆë…•í•˜ì„¸ìš”. ì„œìš¸ì—­ ì•ì— ìœ„ì¹˜í•œ ì„œìš¸ ë°±í™”ì ì…ë‹ˆë‹¤. ì €í¬ ë°±
                    í™”ì <input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì—" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì„œ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ëŠ”" maxlength="1">ê²¨ìš¸ì² ì„ ë§<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì•„" maxlength="1">ê²¨ìš¸ì˜·ê³¼ ë‚œ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë°©" maxlength="1">ì œí’ˆì„ ì„¸ì¼<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="í•˜" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê³ " maxlength="1">ìˆìŠµë‹ˆ
                    ë‹¤. ì§ì¥ ì—¬<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì„±" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì„" maxlength="1">ìœ„í•œ ì—¬ì„±ë³µ ì½”ë„ˆ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì—" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì„œ" maxlength="1">ì—¬ì„± ì •<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì¥" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê³¼" maxlength="1">ê²¨ìš¸ ì†<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì˜·" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì„" maxlength="1">
                    50 í”„ë¡œ ì„¸ì¼í•˜ê³  ìˆ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê³ " maxlength="1">, ì‚¼ì¸µ ì•„ë™<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë³µ" maxlength="1">ì½”ë„ˆì—ì„œë„ ì½”<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="íŠ¸" maxlength="1">, ëª©ë„
                    ë¦¬, ì¥<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê°‘" maxlength="1">ë“±ì˜ ê²¨<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ìš¸" maxlength="1">ìƒí’ˆì´ ê° 30í”„ë¡œì”© í• <input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì¸" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ëœ" maxlength="1">ê°€ê²©ì— íŒ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë§¤" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë˜" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê³ " maxlength="1">
                    ìˆìŠµë‹ˆë‹¤. ì¹ <input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì¸µ" maxlength="1">ì—ì„œëŠ” ì§‘ì•ˆì„ ë”°<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ëœ»" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="í•˜" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê²Œ" maxlength="1">í•´ ì¤„ ì „<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê¸°" maxlength="1">íˆí„°ì™€ ê°€ìŠ¤
                    ë‚œ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë¡œ" maxlength="1">ë“± ë‹¤ì–‘<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="í•œ" maxlength="1">ë‚œë°©ìš© ê°€<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì „" maxlength="1">ì œí’ˆì„ íŠ¹ê°€íŒ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë§¤" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="í•˜" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê³ " maxlength="1">ìˆìŠµë‹ˆë‹¤. ì €
                    <input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="í¬" maxlength="1">ì„œìš¸ ë°±í™”ì ê³¼ í•¨<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê»˜" maxlength="1">ê²¨ìš¸ë‚˜ê¸° ì¤€<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë¹„" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë¥¼" maxlength="1">ì‹œì‘í•˜ì„¸ìš”. ê³ ê° ì—¬ëŸ¬
                    ë¶„ì˜ ë§ì€ ì„±ì› ë¶€íƒë“œë¦½ë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤.
                </div>
            </div>

            <div class="passage">
                <h3>ì§€ë¬¸ 4: êµí†µ ì²´ì¦ (Level 2)</h3>
                <div class="passage-text">
                    ë„ì‹œì˜ ê°€ì¥ í° ë¬¸ì œì ì´ë¼ë©´ ë­ë‹ˆë­ë‹ˆí•´ë„ êµí†µ ë¬¸ì œê°€ ì œì¼ í¬
                    ë‹¤. ë„ë¡œì—ì„œëŠ” êµ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="í†µ" maxlength="1">ì²´ì¦ìœ¼ë¡œ ì¸<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="í•˜" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì—¬" maxlength="1">ì—ë„ˆì§€ì™€ ì‹œ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê°„" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì´" maxlength="1">ë‚­ë¹„ëœë‹¤.
                    íŠ¹íˆ ì¶œ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="í‡´" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê·¼" maxlength="1">ì‹œê°„ì—ëŠ” í•œêº¼<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë²ˆ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì—" maxlength="1">ì°¨ëŸ‰ì´ ì¼ì œ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="íˆ" maxlength="1">ëª°ë ¤ì„œ ë„<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë¡œ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê°€" maxlength="1">ì•„
                    ì£¼ ë³µ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì¡" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="í•˜" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë‹¤" maxlength="1">. ê²Œë‹¤ê°€ ë‰´ìš• ê°™ì€ ëŒ€ë„<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì‹œ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì˜" maxlength="1">ì£¼ì°¨ë‚œì€ ë§¤<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ìš°" maxlength="1">ì‹¬ê°í•œ
                    ìˆ˜ì¤€<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì´" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë‹¤" maxlength="1">. ìë™<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì°¨" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ëŠ”" maxlength="1">ì ì  ë§ì•„<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì§€" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ëŠ”" maxlength="1">ë°˜ë©´ ì£¼<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì°¨" maxlength="1">ê³µê°„ì€ ì œ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="í•œ" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë˜" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì–´" maxlength="1">ìˆ
                    ê¸° ë•Œ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë¬¸" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì—" maxlength="1">ì£¼ì°¨ë‚œì´ ìƒ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê¸´" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë‹¤" maxlength="1">. ì£¼ì°¨ì¥ì´ ë¶€ì¡±í•˜ë©´ ì‚¬ëŒ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë“¤" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì´" maxlength="1">ì£¼íƒ
                    ê°€ ê³¨<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ëª©" maxlength="1">ì´ë‚˜ ë„ë¡œì—ê¹Œì§€ ì£¼ì°¨ë¥¼ í•˜<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ëŠ”" maxlength="1">ê²½ìš°ê°€ ë§ë‹¤. ì´ë ‡ê²Œ ë¶ˆ<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ë²•" maxlength="1">
                    ìœ¼ë¡œ ì£¼<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì°¨" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ëœ" maxlength="1">ì°¨ëŸ‰ì€ ë˜ ë‹¤ì‹œ êµí†µ í˜¼<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì¡" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì˜" maxlength="1">ì›ì¸ì´ ë˜<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ì–´" maxlength="1">ë” ì‹¬<input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="ê°" maxlength="1"><input class="blank" type="text" inputmode="text" autocomplete="off" data-answer="í•œ" maxlength="1">
                    êµí†µ ì²´ì¦ì„ ì¼ìœ¼í‚¨ë‹¤. ë”°ë¼ì„œ êµí†µ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ
                    ëŠ” ìê°€ìš©ë³´ë‹¤ëŠ” ë²„ìŠ¤ë‚˜ ì§€í•˜ì² ì„ ë§ì´ ì´ìš©í•´ì•¼ í•  ê²ƒì´ë‹¤.
                </div>
            </div>

            <button class="btn" onclick="finishTest()">ì‹œí—˜ ì™„ë£Œ</button>
        </div>

        <div id="resultArea" class="results">
            <div class="score" id="score">0%</div>
            <p>ì´ <span id="total">0</span>ë¬¸í•­ ì¤‘ <span id="correct">0</span>ë¬¸í•­ ì •ë‹µ</p>
            <p>ì‚¬ìš© ì‹œê°„: <span id="timeUsed">0</span>ë¶„</p>
            <br>
            <button class="btn" onclick="downloadCSV()">ê²°ê³¼ ë‹¤ìš´ë¡œë“œ (CSV)</button>
            
            <div style="background: #e8f5e8; border: 2px solid #4caf50; padding: 20px; border-radius: 10px; margin: 30px 0; text-align: center;">
                <h3 style="color: #2e7d32; margin-bottom: 15px;">ìˆ˜ê³  ë§ìœ¼ì…¨ìŠµë‹ˆë‹¤. Part 2ê°€ ë§ˆë¬´ë¦¬ ë˜ì—ˆìŠµë‹ˆë‹¤.</h3>
                <p style="color: #388e3c; font-size: 1.1em; margin-bottom: 20px;">ì´ì œ Part 3. ì‘ì—… ê¸°ì–µ ê³¼ì œ (15ë¶„)ë¡œ ì´ë™í•©ë‹ˆë‹¤.</p>
                <a href="https://yueunlee-code.github.io/korean-test/part3/" 
                   class="btn" 
                   style="background: #4caf50; text-decoration: none; display: inline-block; margin: 10px;">
                   Part 3. ì‘ì—… ê¸°ì–µ ê³¼ì œ ì‹œì‘í•˜ê¸°
                </a>
                <br>
                <small style="color: #666; margin-top: 10px; display: block;">
                    ë§í¬: https://yueunlee-code.github.io/korean-test/part3/
                </small>
            </div>
        </div>
    </div>

    <script>
        let timer = 20 * 60;
        let interval;
        let startTime;
        let userData = {};

        function startTest() {
            const pname = document.getElementById('pname').value.trim();
            const age = document.getElementById('age').value.trim();
            const major = document.getElementById('major').value.trim();
            const lang = document.getElementById('lang').value.trim();
            const duration = document.getElementById('duration').value;
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phone').value.trim();

            if (!pname || !age || !major || !lang || !duration || !email || !phone) {
                alert('ëª¨ë“  ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            userData = { pname, age, major, lang, duration, email, phone };
            startTime = new Date();

            document.getElementById('startForm').style.display = 'none';
            document.getElementById('testArea').style.display = 'block';

            setupBlankInputs();

            interval = setInterval(function() {
                timer--;
                let min = Math.floor(timer / 60);
                let sec = timer % 60;
                document.getElementById('timer').textContent = `ë‚¨ì€ ì‹œê°„: ${min}:${sec < 10 ? '0' : ''}${sec}`;
                
                if (timer <= 0) {
                    clearInterval(interval);
                    alert('ì‹œê°„ ì¢…ë£Œ! ìë™ ì œì¶œë©ë‹ˆë‹¤.');
                    finishTest();
                }
            }, 1000);
        }

        function setupBlankInputs() {
            const blanks = document.querySelectorAll('.blank');
            blanks.forEach(function(blank, index) {
                blank.id = 'blank_' + index;
                let isComposing = false;
                let previousValue = '';
                
                blank.addEventListener('touchstart', function(e) {
                    e.stopPropagation();
                }, { passive: true });
                
                blank.addEventListener('compositionstart', function() {
                    isComposing = true;
                    previousValue = this.value;
                });
                
                blank.addEventListener('compositionend', function(e) {
                    isComposing = false;
                    setTimeout(() => {
                        processInput.call(this);
                    }, 0);
                });
                
                function processInput() {
                    let value = this.value.trim();
                    let koreanChar = value.match(/[ê°€-í£]/g);
                    
                    if (koreanChar && koreanChar.length > 0) {
                        this.value = koreanChar[0];
                        
                        if (this.value !== previousValue) {
                            previousValue = this.value;
                            setTimeout(() => {
                                moveToNext(this);
                            }, 50);
                        }
                    } else {
                        this.value = '';
                        previousValue = '';
                    }
                }
                
                blank.addEventListener('input', function() {
                    if (!isComposing) {
                        processInput.call(this);
                    }
                });
                
                blank.addEventListener('keydown', function(e) {
                    if (e.key === 'Backspace') {
                        previousValue = '';
                        return;
                    }
                    
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        if (this.value) {
                            moveToNext(this);
                        }
                        return;
                    }
                    
                    if (e.key === 'Tab') {
                        return;
                    }
                    
                    if (this.value && !isComposing && e.key.length === 1) {
                        previousValue = '';
                        this.value = '';
                    }
                });
                
                blank.addEventListener('focus', function() {
                    previousValue = this.value;
                    if (this.value) {
                        this.select();
                    }
                });
                
                blank.addEventListener('paste', function(e) {
                    e.preventDefault();
                });
            });
        }
        
        function moveToNext(currentBlank) {
            const blanks = Array.from(document.querySelectorAll('.blank'));
            const currentIndex = blanks.indexOf(currentBlank);
            
            if (currentIndex < blanks.length - 1) {
                const nextBlank = blanks[currentIndex + 1];
                nextBlank.focus();
            }
        }

        function finishTest() {
            if (!confirm('ì‹œí—˜ì„ ì œì¶œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            
            clearInterval(interval);
            
            const blanks = document.querySelectorAll('.blank');
            let totalCount = 0;
            let correctCount = 0;
            let results = [];
            
            blanks.forEach(function(blank, index) {
                if (blank.dataset.answer) {
                    totalCount++;
                    const isCorrect = blank.value === blank.dataset.answer;
                    if (isCorrect) correctCount++;
                    
                    results.push({
                        item: index + 1,
                        userAnswer: blank.value,
                        correctAnswer: blank.dataset.answer,
                        correct: isCorrect
                    });
                }
            });

            const percentage = Math.round((correctCount / totalCount) * 100);
            const timeUsed = 20 - Math.floor(timer / 60);
            
            window.testResult = {
                userData: userData,
                startTime: startTime,
                endTime: new Date(),
                timeUsed: timeUsed,
                totalCount: totalCount,
                correctCount: correctCount,
                percentage: percentage,
                details: results
            };

            localStorage.setItem(`result_${userData.email.split('@')[0]}_${Date.now()}`, JSON.stringify(window.testResult));

            sendToGoogleSheets(window.testResult, 'C-Test');

            document.getElementById('testArea').style.display = 'none';
            document.getElementById('resultArea').style.display = 'block';
            document.getElementById('score').textContent = percentage + '%';
            document.getElementById('total').textContent = totalCount;
            document.getElementById('correct').textContent = correctCount;
            document.getElementById('timeUsed').textContent = timeUsed;
        }

        function downloadCSV() {
            if (!window.testResult) return;
            
            const r = window.testResult;
            let csv = '';
            
            csv += '=== ì°¸ì—¬ì ê¸°ë³¸ ì •ë³´ ===\n';
            csv += 'Name,Age,Major,MotherTongue,StudyDuration,Email,Phone,TestDate,StartTime,EndTime,TotalTimeUsed\n';
            csv += `${r.userData.pname},${r.userData.age},${r.userData.major},${r.userData.lang},"${r.userData.duration}",${r.userData.email},${r.userData.phone},${r.startTime.toLocaleDateString()},${r.startTime.toLocaleTimeString()},${r.endTime.toLocaleTimeString()},${r.timeUsed}ë¶„\n\n`;
            
            csv += '=== ì ìˆ˜ ìš”ì•½ ===\n';
            csv += 'TotalItems,CorrectCount,IncorrectCount,EmptyCount,AccuracyPercentage\n';
            const emptyCount = r.totalCount - r.correctCount - (r.details.filter(item => item.userAnswer && !item.correct).length);
            csv += `${r.totalCount},${r.correctCount},${r.details.filter(item => item.userAnswer && !item.correct).length},${emptyCount},${r.percentage}%\n\n`;
            
            csv += '=== ì§€ë¬¸ë³„ ìƒì„¸ ê²°ê³¼ ===\n';
            csv += 'PassageNumber,PassageTitle,ItemNumber,CorrectAnswer,UserAnswer,IsCorrect,ItemType\n';
            
            const passages = [
                { title: 'ì§€ë¬¸1_ì¼ìƒìƒí™œ', start: 1, end: 56 },
                { title: 'ì§€ë¬¸2_ì—¬í–‰ê³„íš', start: 57, end: 106 },
                { title: 'ì§€ë¬¸3_ë°±í™”ì ê´‘ê³ ', start: 107, end: 143 },
                { title: 'ì§€ë¬¸4_êµí†µì²´ì¦', start: 144, end: 157 }
            ];
            
            r.details.forEach(function(item, index) {
                let passageInfo = passages.find(p => item.item >= p.start && item.item <= p.end);
                if (!passageInfo) passageInfo = { title: 'ê¸°íƒ€', start: 0, end: 999 };
                
                const passageNumber = passages.indexOf(passageInfo) + 1;
                const userAnswer = item.userAnswer || '(ê³µë°±)';
                const correctAnswer = item.correctAnswer;
                const isCorrect = item.correct ? 'O' : 'X';
                
                let itemType = 'ê¸°íƒ€';
                if (correctAnswer.match(/[ì€ëŠ”ì´ê°€ì„ë¥¼ì—ì„œ]/)) itemType = 'ì¡°ì‚¬';
                else if (correctAnswer.match(/[ë‹¤ìš”ë‹ˆìŠµ]/)) itemType = 'ì–´ë¯¸';
                else if (correctAnswer.match(/[ì„œê²Œì™€ì•„ì–´]/)) itemType = 'ì—°ê²°ì–´ë¯¸';
                else if (correctAnswer.length === 1) itemType = 'ë‹¨ì¼ìŒì ˆ';
                
                csv += `${passageNumber},"${passageInfo.title}",${item.item},${correctAnswer},${userAnswer},${isCorrect},${itemType}\n`;
            });
            
            csv += '\n=== ì˜¤ë‹µ ë¶„ì„ ===\n';
            csv += 'ItemNumber,CorrectAnswer,UserAnswer,ErrorType\n';
            r.details.forEach(function(item) {
                if (!item.correct) {
                    let errorType = '';
                    if (!item.userAnswer) errorType = 'ë¬´ì‘ë‹µ';
                    else if (item.userAnswer.length !== item.correctAnswer.length) errorType = 'ê¸¸ì´ì˜¤ë¥˜';
                    else errorType = 'ëŒ€ì²´ì˜¤ë¥˜';
                    
                    csv += `${item.item},${item.correctAnswer},${item.userAnswer || '(ê³µë°±)'},${errorType}\n`;
                }
            });
            
            csv += '\n=== ì •ë‹µë¥  í†µê³„ ===\n';
            csv += 'Category,Count,Percentage\n';
            const totalAnswered = r.details.filter(item => item.userAnswer).length;
            csv += `ì „ì²´ë¬¸í•­,${r.totalCount},100%\n`;
            csv += `ì •ë‹µ,${r.correctCount},${Math.round(r.correctCount/r.totalCount*100)}%\n`;
            csv += `ì˜¤ë‹µ,${r.details.filter(item => item.userAnswer && !item.correct).length},${Math.round(r.details.filter(item => item.userAnswer && !item.correct).length/r.totalCount*100)}%\n`;
            csv += `ë¬´ì‘ë‹µ,${r.totalCount - totalAnswered},${Math.round((r.totalCount - totalAnswered)/r.totalCount*100)}%\n`;
            
            csv += '\n=== ì§€ë¬¸ë³„ ì •ë‹µë¥  ===\n';
            csv += 'PassageNumber,PassageTitle,TotalItems,CorrectItems,AccuracyRate\n';
            passages.forEach(function(passage, index) {
                const passageItems = r.details.filter(item => item.item >= passage.start && item.item <= passage.end);
                const passageCorrect = passageItems.filter(item => item.correct).length;
                const passageTotal = passageItems.length;
                const passageRate = passageTotal > 0 ? Math.round(passageCorrect/passageTotal*100) : 0;
                csv += `${index + 1},"${passage.title}",${passageTotal},${passageCorrect},${passageRate}%\n`;
            });
            
            const BOM = '\uFEFF';
            const csvWithBOM = BOM + csv;
            
            const blob = new Blob([csvWithBOM], { type: 'text/csv;charset=utf-8;' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Korean_CTest_DetailedResults_${r.userData.email.split('@')[0]}_${new Date().toISOString().slice(0,10)}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        function sendToGoogleSheets(testResults, testType) {
            const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzdXwqWVXTvEjbgyIyQoiBB6b9Ir_1efKUa0PQ-qy3kH-B7vxGwR_aIjAn0xbYySXGllg/exec';
            
            const summary = testType === 'C-Test' ? 
                `C-Test ì •ë‹µ: ${testResults.correctCount}/${testResults.totalCount}, ì •ë‹µë¥ : ${testResults.percentage}%, ì†Œìš”ì‹œê°„: ${testResults.timeUsed}ë¶„` :
                `${testType} ì™„ë£Œ`;
            
            const payload = {
                participantId: testResults.userData.email,
                participantName: testResults.userData.pname,
                testType: testType,
                summary: summary,
                details: {
                    participantInfo: testResults.userData,
                    testResults: testResults,
                    timestamp: new Date().toLocaleString('ko-KR', { timeZone: 'Asia/Seoul', year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false }),
                    site: 'korean-test-main'
                }
            };
            
            console.log('Google Sheets ë°±ì—… ì‹œë„ ì¤‘...', payload);
            
            fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(payload)
            })
            .then(response => {
                console.log(`${testType} ê²°ê³¼ ë°±ì—… ìš”ì²­ì´ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                return 'success';
            })
            .catch(error => {
                console.error('ë°±ì—… ì‹¤íŒ¨:', error);
            });
        }

        console.log('í•œêµ­ì–´ C-Testê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.');
        console.log('ì´ 157ê°œ ë¹ˆì¹¸ì´ êµ¬í˜„ë˜ì—ˆìŠµë‹ˆë‹¤.');
        console.log('Google Sheets ìë™ ë°±ì—… ê¸°ëŠ¥ì´ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤.');
    </script>
</body>
</html>
